# HSE_AI_ML_course_hw_01
Репозиторий с ДЗ №1 по ML\
Автор: Филиппов Илья

В работе был проведен анализ данных о подержаных автомобилях и предложено несколько моделей линейной регрессии, предсказывающиех стоимость автомобиля на основании приведенных данных \
[Ноутбук с выполненными пунктами задания](https://github.com/Neuralist88/HSE_AI_ML_course_hw_01/blob/main/HW1_Regression_with_inference_base.ipynb)

Анализ данных включает в себя:
- [Отчет](https://github.com/Neuralist88/HSE_AI_ML_course_hw_01/blob/main/hw_01_train_dataset_report.html), сгенерированный при помощи ydata-profilling
  Предпросмотр отчета в github недоступен. Привожу скриншот начала отчета
  ![image](https://github.com/user-attachments/assets/a2ea6e3c-ba79-43ca-a20e-ba6b25f853ea)
- удаление объектов с одинаковым признаковым описанием;
- преобразование текстовых данных в числовые и заполнение пропусков медианными значениями;
- нахождение корреляции Пирсона и V-меры Крамера между отдельными признаками, а также между признаками и целевой переменной.

Построение моделей включает в себя:
- использование модели линейной регрессии только на числовых признаках;
- использование L1, L2 и ElasticNet регуляризации;
- добавление категориальных признаков для обучения модели;
- добавление кастомной бизнес-метрики для оценки качества моделей;
- Дополнительно было опробовано создание новых категориальных признаков из признака `name` и их использование при обучении моделей.
  
В результате, все модели показали одинаково плохой результат на метрике $R^2$, которая использовалась в качестве основной, равный примерно $R^2=0.59$.
Вероятная причина этого - то, что я шел строго по заданию и не пытался улучшить качество модели самостоятельно. Единственное, что я сделал - при создании FastAPI приложения удалил признак 'name' вместо того, чтобы преобразовывать его в 18 категориальных признаков при помощи one-hot-encoding. В результате метрика $R^2$ улучшилась практичесеи до 0.69. Данные изменения отражены в [ноутбке](https://github.com/Neuralist88/HSE_AI_ML_course_hw_01/blob/main/data_preprocessing_with_pipeline_test.ipynb) с пайплайном для FatAPI приложения.\
Дополительно стоило бы:
- проверить данные на наличие аномалий и выбросов
- исключить линейно-зависимые признаки (например, один признак из пары `max_power` и `engine`)
- использовать MinMaxScaler вместо StandardScaler, чтобы значения всех признаков лежали в диапазоне [0, 1]

Скриншоты работы FastAPI приложения
1. Запуск приложения из среды разработки VSCode
   ![1](https://github.com/user-attachments/assets/fb0e2b78-c243-4af0-8637-e5950b6ce3c3)
2. Тестирование запроса на предсказание стоимости единичного автомобиля, данные о котором переданы в виде JSON объекта через Swagger
  ![2](https://github.com/user-attachments/assets/7485c967-1f31-44cf-bb1b-a5588c586e11)
3. То же самое, но при тестировании запросе через postman
  ![3](https://github.com/user-attachments/assets/c01f7a6e-1f0f-45ac-83a7-9bbd4bb4e16a)
4. Тестирование запроса на предсказание стоимости списка автомобилей, данные о которых переданы в виде .csv файла через Swagger
  ![4](https://github.com/user-attachments/assets/8105550e-5dbe-4eca-9504-488e7ca937bf)
5. То же самое, но при тестировании запросе через postman
  ![5](https://github.com/user-attachments/assets/b5edb3d5-7e1b-4381-93b9-6271787572bc)

Все данные для тестирования взяты из [тестовой выборки](https://raw.githubusercontent.com/Murcha1990/MLDS_ML_2022/main/Hometasks/HT1/cars_test.csv), используемой при оценке модели линейной регрессии. Для тестирования обработки одного JSON объекта использовался объект с индексом `0` из данной выборки, для тестирования обработки .csv файла - объекты с индексами `0-20` из этой же выборки. Все тестовые данные брались "как есть", ьез какой-либо предобработки. Вся предобработка данных производилась внутри приложения.
Данные, используемые для тестирования приложения находятся в папке [test_data](https://github.com/Neuralist88/HSE_AI_ML_course_hw_01/tree/main/test_data)
Файл [predictions.csv](https://github.com/Neuralist88/HSE_AI_ML_course_hw_01/blob/main/prediction.csv) содержит предсказание для тестовых данных из .csv файла 
